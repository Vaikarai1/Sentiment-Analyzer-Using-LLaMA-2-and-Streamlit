import streamlit as st
from langchain.prompts import PromptTemplate
from langchain.llms import CTransformers

def analyze_sentiment(text):
    llm = CTransformers(model='models/llama-2-7b-chat.ggmlv3.q8_0.bin',
                        model_type='llama',
                        config={'max_new_tokens': 256, 'temperature': 0.7})
    template = """
    Analyze the sentiment of the following text and classify it as Positive, Negative, or Neutral:
    "{text}"
    Provide a brief explanation.
    """

     prompt = PromptTemplate(input_variables=["text"], template=template)
    response = llm(prompt.format(text=text))
    return response
st.set_page_config(page_title="Sentiment Analyzer ðŸ¤–", page_icon='ðŸ˜Š', layout='centered')
st.header("Sentiment Analyzer using LLaMA 2 ðŸ¤–")

input_text = st.text_area("Enter the text for sentiment analysis")
if st.button("Analyze"):
    if input_text:
        result = analyze_sentiment(input_text)
        st.write(result)
    else:
        st.warning("Please enter some text!")
